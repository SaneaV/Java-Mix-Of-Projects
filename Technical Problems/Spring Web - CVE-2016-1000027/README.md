# Spring Web vulnerability CVE-2016-1000027

Pivotal Spring Framework through 5.3.16 suffers from a potential remote code execution (RCE) issue if used for Java
deserialization of untrusted data. Depending on how the library is implemented within a product, this issue may or not occur,
and authentication may be required. NOTE: the vendor's position is that untrusted data is not an intended use case. The
product's behavior will not be changed because some users rely on deserialization of trusted data.

## Main idea of this project

A warning has been provided in the official Javadocs of the HttpInvokerServiceExporter class:

WARNING: Be aware of vulnerabilities due to unsafe Java deserialization: Manipulated input streams could lead to unwanted code
execution on the server during the deserialization step. As a consequence, do not expose HTTP invoker endpoints to untrusted
clients but rather just between your own services. In general, we strongly recommend any other message format (e.g. JSON)
instead.

If we do not load the HttpInvokerServiceExporter class into our project, then the CVE-2016-1000027 vulnerability will not be
considered a vulnerability. To understand if we don't have this class loaded, we need to check the JVM log. There are two
different ways how to do this depending on the version of Java.

### Java 8

1. Add VM options `-verbose -XX:+UnlockDiagnosticVMOptions -XX:+LogVMOutput -XX:-DisplayVMOutput -XX:LogFile=java8.log`
2. Add environment variable `CREATE_HTTP_INVOKER_SERVICE_EXPORTER` set to `false` or `true`
3. Run `Java8.java` class
4. Check `java8.log` (manual approach):
    - In case `CREATE_HTTP_INVOKER_SERVICE_EXPORTER=false` `java8.log` shouldn't contain HttpInvokerServiceExporter entry (The
      vulnerability doesn't affect the application)
    - In case `CREATE_HTTP_INVOKER_SERVICE_EXPORTER=true` `java8.log` should contain HttpInvokerServiceExporter entry (The
      vulnerability affect the application)
5. Check `java8.log` (automatic approach):
    - Run `Checker.java` with `FILE_PATH=java8.log` environment variable

### Java 9

1. Add VM options `-Xlog:class+load=info:java9.txt`
2. Add environment variable `CREATE_HTTP_INVOKER_SERVICE_EXPORTER` set to `false` or `true`
3. Run `Java9.java` class
4. Check `java9.txt` (manual approach):
    - In case `CREATE_HTTP_INVOKER_SERVICE_EXPORTER=false` `java9.txt` shouldn't contain HttpInvokerServiceExporter entry (The
      vulnerability doesn't affect the application)
    - In case `CREATE_HTTP_INVOKER_SERVICE_EXPORTER=true` `java9.txt` should contain HttpInvokerServiceExporter entry (The
      vulnerability affect the application)
5. Check `java9.txt` (automatic approach):
    - Run `Checker.java` with `FILE_PATH=java9.txt` environment variable 